<!DOCTYPE html>
<html>
    <head>
        <title>Line Chart</title>
	    <script src="chart.js/dist/Chart.min.js"></script>
    </head>
    <body>
        <div style="width:75%;">
            <canvas id="myChart"></canvas>
        </div>
        <br><br>
        <button id="addData">Add Data</button>
	    <button id="removeData">Remove Data</button>
        <button id="reload">Reload</button>
        <button id="prevWeek">Last Week</button>
        <script>
            var DAYS = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
            var test = [Math.floor(Math.random() * 101), Math.floor(Math.random() * 101), Math.floor(Math.random() * 101), Math.floor(Math.random() * 101), Math.floor(Math.random() * 101), Math.floor(Math.random() * 101), Math.floor(Math.random() * 101)]
            var currentWeekData = [15, 48, 92, 60, 52, 78, 60]
            var currentWeek = new Date(2021, 2, 15)

            var config = {
                type: 'line',
                data: {
                    labels: DAYS,
                    datasets: [{
                        label: 'Date Starting: ' + currentWeek.toDateString(),
                        data: currentWeekData,
                        fill: false,
                        backgroundColor: 'rgba(133, 207, 240)',
                        borderColor: 'rgba(133, 207, 240)',
                    }]
                },
                options: {
                    responsive: true,

                    title: {
                        display: true,
                        text: 'Chart.js Line Chart'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false,
                    },
                    hover: {
                        mode: 'nearest',
                        intersect: true
                    },
                    scales: {
                        xAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Day'
                            }
                        }],
                        yAxes: [{
                            display: true,
                            scaleLabel: {
                                display: true,
                                labelString: 'Value'
                            },
                            ticks: {
                                max: 100,
                                min: 0,
                            }
                        }]
                    },
                    animation: {
                        duration: 2000,
                    }
                }
            };
            
            window.onload = function() {
                var ctx = document.getElementById('myChart').getContext('2d');
                window.myLine = new Chart(ctx, config);
            };

            document.getElementById('addData').addEventListener('click', function() {
                config.data.datasets.forEach(function(dataset) {
                    if (dataset.data.length < 7){
                        dataset.data.push(Math.floor(Math.random() * 101));
                        console.log('Data added')
                    }
                })
                window.myLine.update();
            });

            document.getElementById('removeData').addEventListener('click', function() {
                config.data.datasets.forEach(function(dataset) {
                    if (dataset.data.length > 0){
                        dataset.data.pop();
                        console.log('Data removed')
                    }
                })
                window.myLine.update();
            });

            document.getElementById('reload').addEventListener('click', function() {
                config.data.datasets.forEach(function(dataset) {
                    var temp = dataset.data;
                    dataset.data = [];
                    window.myLine.update();
                    for (i = 0; i < temp.length; i++) {
                        dataset.data.push(temp[i])
                        window.myLine.update();
                    }
                })
            });

            document.getElementById('prevWeek').addEventListener('click', function() {
                var d = new Date();
                d.setDate(currentWeek.getDate()-7);
                console.log(d)
                var newDataset = {
                    label: 'Week Starting: ' + d.toDateString(),
                    backgroundColor: 'rgba(133, 0, 240)',
                    borderColor: 'rgba(133, 0, 240)',
                    data: test,
                    fill: false
                };
                
                console.log('success')   
                config.data.datasets.push(newDataset)
                window.myLine.update();
            });
        </script>
    </body>
</html>